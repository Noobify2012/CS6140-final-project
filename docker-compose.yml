version: "3.9"
services:
  jupyter-lab:
    container_name: 'jupyter-lab'
    platform: "linux/amd64"
    build: 
      dockerfile: ./Dockerfile-mamba
      context: ./
    command: >
      jupyter lab 
        --allow-root 
        --NotebookApp.allow_origin='*'
        --port=8888 
        --ip=0.0.0.0 
        --no-browser 
        --NotebookApp.token=''
        --browser=False
        --NotebookApp.disable_check_xsrf=True
    networks:
      - cs6140-network
    ports:
      - '8888:8888'
    volumes:
      - type: bind
        source: .
        target: /app

  flights-db:
    container_name: 'flights-db'
    platform: "linux/amd64"
    build:
      dockerfile: ./Dockerfile-postgres
    restart: unless-stopped
    environment:
      - POSTGRES_USER=postgres
      - POSTGRES_PASSWORD=postgres
      - POSTGRES_DB=flights
    networks:
      - cs6140-network
    ports:
      - '5432:5432'
    volumes:
      - db-volume:/var/lib/postgresql/data

volumes:
  db-volume:

networks:
  cs6140-network:
